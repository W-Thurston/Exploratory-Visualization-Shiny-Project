group_by(events, season) %>%
count(., league) %>%
ggplot(., aes(x=league,y=n))+geom_col(aes(fill=season))
group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(x=league,y=n))+geom_col(aes(fill=season))
matches$season <- as.factor(matches$season)
group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(x=league,y=n))+geom_col(aes(fill=season))
# write.csv(events, file = "../football-events/eventsCleaned.csv")
# write.csv(matches, file = "../football-events/matchesCleaned.csv")
# Read in data ####
events <- fread('../football-events/events.csv')
matches <- fread('../football-events/ginf.csv')
events <- left_join(events, matches[,c('id_odsp','league','season','ht','at','fthg','ftag')], by = "id_odsp")
events$is_goal <- as.logical(events$is_goal)
events$bodypart <- as.factor(events$bodypart)
events$assist_method <- as.factor(events$assist_method)
events$id_odsp <- as.factor(events$id_odsp)
events$league <- as.factor(events$league)
events <- events[events$season>2014,]
matches <- matches[matches$season>2014,]
events$season <- as.factor(events$season)
matches$season <- as.factor(matches$season)
levels(events$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
levels(matches$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(x=league,y=n))+geom_col(aes(fill=season))
matches <- fread('../football-events/ginf.csv')
group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(x=league,y=n))+geom_col(aes(fill=season),position='dodge')
ents <- left_join(events, matches[,c('id_odsp','league','season','ht','at','fthg','ftag')], by = "id_odsp")
# Changing data types of events table ####
events$is_goal <- as.logical(events$is_goal)
events$bodypart <- as.factor(events$bodypart)
events$assist_method <- as.factor(events$assist_method)
events$id_odsp <- as.factor(events$id_odsp)
events$league <- as.factor(events$league)
events <- events[events$season>2014,]
events$season <- as.factor(events$season)
matches$league <- as.factor(matches$league)
matches$season <- as.factor(matches$season)
levels(events$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
levels(matches$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(x=league,y=n))+geom_col(aes(fill=season),position='dodge')
group_by(matches, season) %>%
count(., league) %>%
#ggplot(., aes(x=league,y=n))+geom_col(aes(fill=season),position='dodge')
gvisBarChart(., xvar='league', yvar="n",
options= list(title="Goals", legend='none',colors="['3cb371']",width = "automatic",
height = "automatic"))
group_by(matches, season) %>%
count(., league) %>%
#ggplot(., aes(x=league,y=n))+geom_col(aes(fill=season),position='dodge')
gvisBarChart(., xvar='league', yvar="n",
options= list(title="Goals", legend='none',colors="['3cb371']",width = "automatic",
height = "automatic"))
plot(a)
df <- data.frame(country=c("US", "GB", "BR"),
val1=c(1,3,4),
val2=c(23,12,32))
## Bar chart
Bar1 <- gvisBarChart(df, xvar="country", yvar=c("val1", "val2"))
plot(Bar1)
group_by(matches, season) %>%
count(., league)
install.packages("plotly")
group_by(matches, season) %>%
count(., league)
group_by(matches, season) %>%
count(., league) %>%
plot_ly(
x = league,
y = n,
type = "bar",
group = season)
group_by(matches, season) %>%
count(., league) %>%
plot_ly()
library(plotly)
group_by(matches, season) %>%
count(., league) %>%
plot_ly(
x = league,
y = n,
type = "bar",
group = season)
group_by(matches, season) %>%
count(., league) %>%
plot_ly(.,
x = league,
y = n,
type = "bar",
group = season)
group_by(matches, season) %>%
count(., league) %>%
plot_ly(.,
x = ~league,
y = ~n,
type = "bar",
group = ~season)
group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(league, n)) +
geom_bar(aes(fill = season), position = "dodge", stat="identity")+scale_color_manual(values=c(rep("white", 17)))+theme(legend.position="none")
group_by(matches, season) %>%
count(., league)
group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(league, n)) +
geom_bar(aes(fill = season, color=league), position = "dodge", stat="identity")+scale_color_manual(values=c(rep("white", 17)))+theme(legend.position="none")
plot(a)
a = group_by(matches, season) %>%
count(., league) %>%
#ggplot(., aes(x=league,y=n))+geom_col(aes(fill=season),position='dodge')
gvisBarChart(., xvar='league', yvar="n",
options= list(title="Goals", legend='none',colors="['3cb371']",width = "automatic",
height = "automatic"))
plot(a)
a = group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(x=league,y=n))+geom_col(aes(fill=season),position='dodge')
plot(a)
# write.csv(events, file = "../football-events/eventsCleaned.csv")
# write.csv(matches, file = "../football-events/matchesCleaned.csv")
# Read in data ####
events <- fread('../football-events/events.csv')
matches <- fread('../football-events/ginf.csv')
events <- left_join(events, matches[,c('id_odsp','league','season','ht','at','fthg','ftag')], by = "id_odsp")
events$is_goal <- as.logical(events$is_goal)
events$bodypart <- as.factor(events$bodypart)
events$assist_method <- as.factor(events$assist_method)
events$id_odsp <- as.factor(events$id_odsp)
events$league <- as.factor(events$league)
events <- events[events$season>2014,]
matches <- matches[matches$season>2014,]
events$season <- as.factor(events$season)
matches$league <- as.factor(matches$league)
matches$season <- as.factor(matches$season)
levels(events$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
levels(matches$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
a = group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(x=league,y=n))+geom_col(aes(fill=season),position='dodge')
plot(a)
rm(list=ls())
events$is_goal <- as.logical(events$is_goal)
events$bodypart <- as.factor(events$bodypart)
events$assist_method <- as.factor(events$assist_method)
events$id_odsp <- as.factor(events$id_odsp)
events$league <- as.factor(events$league)
events$season <- as.factor(events$season)
matches$league <- as.factor(matches$league)
matches$season <- as.factor(matches$season)
levels(events$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
levels(matches$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
# write.csv(events, file = "../football-events/eventsCleaned.csv")
# write.csv(matches, file = "../football-events/matchesCleaned.csv")
# Read in data ####
events <- fread('../football-events/events.csv')
matches <- fread('../football-events/ginf.csv')
events <- left_join(events, matches[,c('id_odsp','league','season','ht','at','fthg','ftag')], by = "id_odsp")
events$is_goal <- as.logical(events$is_goal)
events$bodypart <- as.factor(events$bodypart)
events$assist_method <- as.factor(events$assist_method)
events$id_odsp <- as.factor(events$id_odsp)
events$league <- as.factor(events$league)
events$season <- as.factor(events$season)
matches$league <- as.factor(matches$league)
matches$season <- as.factor(matches$season)
levels(events$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
levels(matches$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
summary(matches[matches$adv_stats==F,c('league','season')])
summary(matches[matches$adv_stats==F,c('league','season')&matches$season>2013])
summary(matches[matches$adv_stats==F,c('league','season')&matches$season>2013])
# write.csv(events, file = "../football-events/eventsCleaned.csv")
# write.csv(matches, file = "../football-events/matchesCleaned.csv")
# Read in data ####
events <- fread('../football-events/events.csv')
matches <- fread('../football-events/ginf.csv')
events <- left_join(events, matches[,c('id_odsp','league','season','ht','at','fthg','ftag')], by = "id_odsp")
# Changing data types of events table ####
events$is_goal <- as.logical(events$is_goal)
events$bodypart <- as.factor(events$bodypart)
events$assist_method <- as.factor(events$assist_method)
events$id_odsp <- as.factor(events$id_odsp)
events$league <- as.factor(events$league)
matches$league <- as.factor(matches$league)
levels(events$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
levels(matches$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
summary(matches[matches$adv_stats==F,c('league','season')&matches$season>2013])
levels(events$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
levels(matches$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
summary(matches[matches$adv_stats==F,c('league','season') & matches$season>2013])
summary(matches[(matches$adv_stats==F,c('league','season')) & (matches$season>2013) ])
summary(matches[(matches$adv_stats==F,c('league','season')) ])
summary(matches[matches$adv_stats==F,c('league','season') & (matches$season>2013) ])
summary(matches[matches$adv_stats==F& (matches$season>2013),c('league','season')  ])
summary(matches[matches$adv_stats==F,c('league','season')  ])
matches <- matches[matches$season>2013,]
summary(matches[matches$adv_stats==F,c('league','season')  ])
matches$season <- as.factor(matches$season)
summary(matches[matches$adv_stats==F,c('league','season')  ])
# write.csv(events, file = "../football-events/eventsCleaned.csv")
# write.csv(matches, file = "../football-events/matchesCleaned.csv")
# Read in data ####
events <- fread('../football-events/events.csv')
matches <- fread('../football-events/ginf.csv')
events <- left_join(events, matches[,c('id_odsp','league','season','ht','at','fthg','ftag')], by = "id_odsp")
events <- events[events$season>2014,]
matches <- matches[matches$season>2014,]
events$is_goal <- as.logical(events$is_goal)
events$bodypart <- as.factor(events$bodypart)
events$assist_method <- as.factor(events$assist_method)
events$id_odsp <- as.factor(events$id_odsp)
events$league <- as.factor(events$league)
events$season <- as.factor(events$season)
matches$league <- as.factor(matches$league)
matches$season <- as.factor(matches$season)
levels(events$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
levels(matches$league) <- c('Bundesliga','Premier League','Ligue 1','Serie A','La Liga')
summary(matches[matches$adv_stats==F,c('league','season')  ])
summary(matches[matches$adv_stats==T,c('league','season')  ])
group_by(matches,season) %>%
count(.,league)
group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(league, n)) +
geom_bar(aes(fill = season, color=league), position = "dodge", stat="identity")+scale_color_manual(values=c(rep("white", 17)))+theme(legend.position="none")
group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(league, n)) +
geom_bar(aes(fill = season, color=league), position = "dodge", stat="identity")
group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(league, n)) +
geom_bar(aes(fill = season), position = "dodge", stat="identity")
# Goals stats ####
matches$goals = (matches$fthg + matches$ftag)
goals = group_by(matches, league) %>%
summarise(., goals = sum(goals))
goals
number_of_matches = count(matches, league)
shots = events[events$event_type == 1,] %>% count(league)
# Begin creating the table of ratios
ratio_table = left_join(number_of_matches, goals, by='league')
names(ratio_table) = c("league", "number_of_matches", "goals" )
ratio_table$goals_per_match = ratio_table$goals/ratio_table$number_of_matches
ratio_table = left_join(ratio_table, shots, by='league')
names(ratio_table) = c("league", "number_of_matches", "goals", "goals_per_match", "shots")
ratio_table$goals_per_shot = round(ratio_table$goals/ratio_table$shots,2)
ratio_table$shots_per_match = round(ratio_table$shots/ratio_table$number_of_matches,2)
ratio_table
# Goals stats ####
matches$goals = (matches$fthg + matches$ftag)
goals = group_by(matches, league) %>%
summarise(., goals = sum(goals))
number_of_matches = count(matches, league)
shots = events[events$event_type == 1,] %>% count(league)
# Begin creating the table of ratios
ratio_table = left_join(number_of_matches, goals, by='league')
ratio_table
names(ratio_table) = c("league", "number_of_matches", "goals" )
ratio_table
ratio_table$goals_per_match = ratio_table$goals/ratio_table$number_of_matches
ratio_table
ratio_table$goals_per_match = round(ratio_table$goals/ratio_table$number_of_matches,4)
ratio_table
ratio_table$goals_per_match = ratio_table$goals/ratio_table$number_of_matches
ratio_table = left_join(ratio_table, shots, by='league')
names(ratio_table) = c("league", "number_of_matches", "goals", "goals_per_match", "shots")
ratio_table
ratio_table$goals_per_shot = round(ratio_table$goals/ratio_table$shots,4)
ratio_table$shots_per_match = round(ratio_table$shots/ratio_table$number_of_matches,3)
ratio_table
ratio_table$shots_per_match = round(ratio_table$shots/ratio_table$number_of_matches,4)
ratio_table
ratio_table = left_join(number_of_matches, goals, by='league')
names(ratio_table) = c("league", "number_of_matches", "goals" )
ratio_table = left_join(ratio_table, shots, by='league')
names(ratio_table) = c("league", "number_of_matches", "goals", "goals_per_match", "shots")
ratio_table$goals_per_match = ratio_table$goals/ratio_table$number_of_matches
ratio_table$goals_per_shot = round(ratio_table$goals/ratio_table$shots,4)
ratio_table$shots_per_match = round(ratio_table$shots/ratio_table$number_of_matches,4)
ratio_table
# Begin creating the table of ratios
ratio_table = left_join(number_of_matches, goals, by='league')
names(ratio_table) = c("league", "number_of_matches", "goals" )
ratio_table = left_join(ratio_table, shots, by='league')
# Begin creating the table of ratios
ratio_table = left_join(number_of_matches, goals, by='league')
names(ratio_table) = c("league", "number_of_matches", "goals" )
ratio_table = left_join(ratio_table, shots, by='league')
names(ratio_table) = c("league", "number_of_matches", "goals", "shots")
ratio_table$goals_per_match = ratio_table$goals/ratio_table$number_of_matches
ratio_table$goals_per_shot = round(ratio_table$goals/ratio_table$shots,4)
ratio_table$shots_per_match = round(ratio_table$shots/ratio_table$number_of_matches,4)
ratio_table
ratio_table$goals_per_match = ratio_table$goals/ratio_table$number_of_matches
ratio_table$goals_per_shot = ratio_table$goals/ratio_table$shots
ratio_table$shots_per_match = ratio_table$shots/ratio_table$number_of_matches
ratio_table
ratio_table$goals_per_match = as.numeric(ratio_table$goals_per_match)
ratio_table$goals_per_shot  = as.numeric(ratio_table$goals_per_shot)
ratio_table$shots_per_match = as.numeric(ratio_table$shots_per_match)
ratio_table
gather(ratio_table, "type", "value",-league) %>%
ggplot(., aes(x=league,y=value)) + geom_col() + facet_wrap(~type)
result = group_by(events, league) %>%
count(., event_type)
result
result = group_by(events, season,league) %>%
count(., event_type)
result
result %>% tbl_df %>% print(n=145)
# str(matches)
head(matches)
fouls = events[events$event_type == 3,] %>% count(league)
yellow = events[events$event_type == 4,] %>% count(league)
syellow = events[events$event_type == 5,] %>% count(league)
red = events[events$event_type == 6,] %>% count(league)
foul_table = left_join(number_of_matches,fouls, by='league')
foul_table = left_join(foul_table,yellow, by='league')
foul_table = left_join(foul_table,syellow, by='league')
foul_table = left_join(foul_table,red, by='league')
names(foul_table) = c("league", "number_of_matches", "fouls", "yellows", "second_yellows","reds")
foul_table$fouls_per_match = round(foul_table$fouls/foul_table$number_of_matches,2)
foul_table$yellows_per_match = round(foul_table$yellows/foul_table$number_of_matches,2)
foul_table$syellows_per_match = round(foul_table$second_yellows/foul_table$number_of_matches,2)
foul_table$reds_per_match = round(foul_table$reds/foul_table$number_of_matches,2)
foul_table$cards = round(foul_table$yellows+foul_table$second_yellows+foul_table$reds,2)
foul_table$cards_per_match = round(foul_table$cards/foul_table$number_of_matches,2)
foul_table
ratio_table
events[events$event_type == 3,]
events[events$event_type == 4,]
events[events$event_type == 5,]
foul_table
group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(league, n)) +
geom_bar(aes(fill = season), position = "dodge", stat="identity")
df=data.frame(country=c("US", "GB", "BR"),
val1=c(10,13,14),
val2=c(23,12,32))
df
group_by(matches, season) %>%
count(., league)
group_by(matches, leauge) %>%
count(., league)
group_by(matches, league) %>%
count(., league)
group_by(matches, league) %>%
count(., season)
group_by(matches, season) %>%
count(., league)
group_by(matches, league) %>%
count(., season) %>%
spread(., season, n)
Column <- group_by(matches, league) %>%
count(., season) %>%
spread(., season, n) %>%
gvisColumnChart(.)
plot(Column)
runApp()
# 2	Corner
# 3	Foul
# 4	Yellow card
# 5	Second yellow card
# 6	Red card
# 7	Substitution
# 8	Free kick won
# 9	Offside
# 10	Hand ball
# 11	Penalty conceded
ychoice1 = c("number_of_matches", "goals", "shots")
ychoice2 = c("number_of_matches", "goals", "shots", "goals_per_match","shots_per_match","goals_per_shot")
runApp()
events[events$situation== 2,]
group_by(events, situation) %>%
count(., league)
group_by(events, situation) %>%
count(., league)%>% tbl_df %>% print(n=30)
foul_table
# str(events)
head(events)
# str(events)
head(events)
str(events)
write.csv(events, file = "../football-events/eventsCleaned.csv")
write.csv(matches, file = "../football-events/matchesCleaned.csv")
head(events[is.null(events$player_in)],20)
head(events[is.null(events$shot_place)],20)
head(events[is.null(events$shot_place),],20)
head(events[is.na(events$shot_place),],20)
head(events[is.na(events$player2),],20)
is.na(<NA>)
str(events)
# Fouls ####
head(events[events$event_type == 3,]
# Fouls ####
head(events[events$event_type == 3,])
# Fouls ####
head(events[events$event_type == 3,])
# Fouls ####
head(anyNA(events[events$event_type == 3,]))
# Fouls ####
head(anyNA(events[events$event_type == 3,"event_type"]))
# Fouls ####
head(anyNA(events[events$event_type == 4,"event_type"]))
# Fouls ####
head(anyNA(events[events$event_type == 5,"event_type"]))
# Fouls ####
head(anyNA(events[events$event_type2 == 12,"event_type2"]))
events[events$event_type2 == 12,"event_type2"]
# Fouls ####
head(anyNA(events[which(events$event_type2 == 12),"event_type2"]))
events[which(events$event_type2 == 12),"event_type2"]
fouls = events[which(events$event_type == 3),] %>% count(league)
yellow = events[which(events$event_type == 4),] %>% count(league)
syellow = events[which(events$event_type == 5),] %>% count(league)
red = events[which(events$event_type == 6),] %>% count(league)
foul_table = left_join(number_of_matches,fouls, by='league')
foul_table = left_join(foul_table,yellow, by='league')
foul_table = left_join(foul_table,syellow, by='league')
foul_table = left_join(foul_table,red, by='league')
names(foul_table) = c("league", "number_of_matches", "fouls", "yellows", "second_yellows","reds")
foul_table$fouls_per_match = round(foul_table$fouls/foul_table$number_of_matches,2)
foul_table$yellows_per_match = round(foul_table$yellows/foul_table$number_of_matches,2)
foul_table$syellows_per_match = round(foul_table$second_yellows/foul_table$number_of_matches,2)
foul_table$reds_per_match = round(foul_table$reds/foul_table$number_of_matches,2)
foul_table$cards = round(foul_table$yellows+foul_table$second_yellows+foul_table$reds,2)
foul_table$cards_per_match = round(foul_table$cards/foul_table$number_of_matches,2)
foul_table
# Fouls ####
head(events[which(events$event_type == 3),])
events[which(events$event_type == 3),] %>% count(league)
events[which(events$event_type == 4),] %>% count(league)
events[which(events$event_type == 3),] %>%
group_by(., league) %>%
summarise(., n())
foul_table
events[which(events$event_type == 3),] %>%
group_by(., season, league) %>%
summarise(., n())
events[which(events$event_type == 4),] %>%
group_by(., season, league) %>%
summarise(., n())
count(events,event_type)
group_by(events, season) %>%
count(.,event_type)
group_by(events, season,league) %>%
count(.,event_type)
events[which(events$event_type == 4),] %>%
group_by(., season, league) %>%
summarise(., n())%>% tbl_df %>% print(n=145)
group_by(events, season,league) %>%
count(.,event_type)%>% tbl_df %>% print(n=145)
events[which(events$event_type == 3 & events$season == 2015),]
events[which(events$event_type == 4 & events$season == 2015),]
events[which(events$event_type == 4 & events$season == 2015 & events$league == 'Bundesliga'),]
events[which(events$situation == 4,]
events[which(events$situation == 4),]
events[which(events$situation == 4 & is_goal),]
events[which(events$situation == 4 & events$is_goal == T),]
events[which(events$situation == 4),] %>%
count(., is_goal)
events[which(events$situation == 4),] %>%
group_by(., season, league) %>%
count(., is_goal)
events[which(events$situation == 4),] %>%
group_by(., season, league) %>%
count(., is_goal)%>% tbl_df %>% print(n=145)
events[which(events$situation == 4),] %>%
group_by(., season, league) %>%
count(., is_goal) %>%
spread(., is_goal, n) %>% tbl_df %>% print(n=145)
events[which(events$situation == 2),] %>%
group_by(., season, league) %>%
count(., is_goal) %>%
spread(., is_goal, n) %>% tbl_df %>% print(n=145)
events[which(events$event_type == 4),] %>%
group_by(., season, league) %>%
summarise(., n())
foul_table
runApp()
events[which(events$is_goal == T), ] %>%
group_by(., location)
events[which(events$situation == 2),] %>%
group_by(., location) %>%
count(., is_goal) %>%
spread(., is_goal, n) %>% tbl_df %>% print(n=145)
events[which(events$is_goal == T), ] %>%
group_by(., location)%>%
count(., is_goal) %>%
spread(., is_goal, n) %>% tbl_df %>% print(n=145)
Column <- group_by(matches, league) %>%
count(., season) %>%
spread(., season, n) %>%
gvisColumnChart(.)
plot(Column)
group_by(matches, season) %>%
count(., league) %>%
ggplot(., aes(league, n)) +
geom_bar(aes(fill = season), position = "dodge", stat="identity")
runApp()
runApp()
